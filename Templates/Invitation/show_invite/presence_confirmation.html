<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Invitation — easyInvite</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="/static/Js/index.js" defer></script>
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    body {
      font-family: "Poppins", sans-serif;
      background-color: #f9f9f9;
    }

    .invitation-card {
      max-width: 600px;
      margin: 50px auto;
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.08);
    }

    .hero-img {
      border-radius: 16px;
      max-height: 300px;
      object-fit: cover;
      width: 100%;
    }

    .btn-confirm {
      border-radius: 30px;
      padding: 12px 28px;
      font-weight: 600;
      margin: 5px;
    }

    .btn-yes {
      background-color: #28a745;
      color: white;
    }

    .btn-yes:hover {
      background-color: #218838;
      color: white;
    }

    .btn-no {
      background-color: #dc3545;
      color: white;
    }

    .btn-no:hover {
      background-color: #c82333;
      color: white;
    }

    textarea {
      border-radius: 12px;
    }

    .confirmation-msg {
      display: none;
    }
  </style>
</head>
<body>

<div class="invitation-card text-center">

  <!-- Event Image -->
  <img src="https://images.unsplash.com/photo-1529634806980-85c3dd6d34ac" alt="Événement" class="hero-img mb-4">

  <!-- Event Title -->
  <h2 class="fw-bold mb-2">{{guest.event.name}}</h2>
  <p class="text-muted mb-4">Le {{guest.event.date.strftime('%d-%m-%Y')}} à l'adresse : {{guest.event.address}}</p>
  <!-- RSVP Buttons -->
  <div class="mb-3">
    <form action="/presence/confirmation/{{guest.id}}/{{event_id}}" method="post">
      <button type="submit" class="btn btn-confirm btn-yes" name="response" value="yes" onclick="confirmEvent('yes')">✅ Je serai là</button>
      <button type="submit" class="btn btn-confirm btn-no" name="response" value="no" onclick="confirmEvent('no')">❌ Je ne serai pas là</button>
    </form>

     {%if message%}
    <div class="container alert alert-warning message-section">
      <p>{{message}}</p>
    </div>
     {%endif%}
  </div>



</div>

<script>
 async function confirmEvent(response){
    document.querySelector('.btn-yes').disaled = true;
    document.querySelector('.btn-no').disaled = true;
    console.log("btn clique : ",response)
    try {
      const res = await fetch(`/confirm-event`,{
        method:'POST',
        headers:{'content-Type':'application/json'},
        body:JSON.stringify({
          response:response
        })
      })
      const data = await res.json();
      alert(data.message);
    }
    catch (error){
      console.log(error);
    document.querySelector('.btn-yes').disaled=false;
    document.querySelector('.btn-no').disaled=false;
    }
    
  }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>